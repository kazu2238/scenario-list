function encodeString(e){var t=new Uint8Array(e);switch(Encoding.detect(t)){case"UTF16":t=new Uint16Array(e);break;case"UTF32":t=new Uint32Array(e)}var n=Encoding.convert(t,"UNICODE"),r=Encoding.codeToString(n);return r}function nowTextDate(){var e=new Date;return timeText=sprintf("{0}{1}{2}{3}",[paddingLeft(String(e.getHours()),2),paddingLeft(String(e.getMinutes()),2),paddingLeft(String(e.getSeconds()),2),paddingLeft(String(e.getMilliseconds()),3)]),timeText}function paddingLeft(e,t){for(var n=String(e);;){if(n.length>=t)break;n="0"+n}return n}function sprintf(e,t){for(var n=e,r=0;r<t.length;r++)n=n.replace(new RegExp("\\{"+r+"\\}","g"),t[r]);return n}$(document).ready(function(){$("body").on("drop",function(e){e.preventDefault()}),$(".dnd").on("drop",function(e){var t=e.originalEvent.dataTransfer.files[0],n=t.name.replace(/(.text|.txt)/g,""),r=nowTextDate(),a=t.type;if(a.match(/text.*/)){var i=new FileReader;i.onload=function(e){var t=encodeString(e.target.result);$.ajax({url:"texshare/upload",type:"POST",data:{name:r,title:n,text:t},success:function(){$(".tes").append("<a href='/page/"+r+"'>"+n+"</a><br>")}})},i.readAsArrayBuffer(t)}else alert("text\u30d5\u30a1\u30a4\u30eb\u306e\u307f")}),$("body").on("dragover",function(e){e.preventDefault()})});